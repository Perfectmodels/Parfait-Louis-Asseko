# Schéma pour l'application de gestion de modèles et castings

# Utilisateur du système
type User @table {
  id: String! @default(expr: "auth.uid")
  email: String! @col(dataType: "varchar(255)")
  displayName: String
  photoURL: String
  role: UserRole! @default(value: MODEL)
  status: UserStatus! @default(value: PENDING)
  createdAt: Timestamp! @default(expr: "now()")
  updatedAt: Timestamp! @default(expr: "now()")
  
  # Relations
  profile: UserProfile
  applications: [CastingApplication!]!
  bookings: [Booking!]!
}

# Profil utilisateur détaillé
type UserProfile @table {
  user: User! @unique
  firstName: String!
  lastName: String!
  phone: String
  birthDate: Date
  height: Int
  weight: Int
  measurements: Measurements
  eyeColor: String
  hairColor: String
  nationality: String
  languages: [String!]
  portfolioImages: [String!]
  bio: String
  skills: [String!]
  experience: [Experience!]
  socialLinks: SocialLinks
}

# Modèle de mesure
type Measurements {
  bust: Int
  waist: Int
  hips: Int
  dress: Int
  shoes: Int
}

# Expérience professionnelle
type Experience {
  id: ID! @default(expr: "uuidV4()")
  title: String!
  company: String
  startDate: Date!
  endDate: Date
  current: Boolean
  description: String
}

# Liens sociaux
type SocialLinks {
  instagram: String
  facebook: String
  twitter: String
  linkedin: String
  website: String
}

# Casting
type Casting @table {
  id: ID! @default(expr: "uuidV4()")
  title: String!
  description: String!
  location: String
  startDate: Timestamp!
  endDate: Timestamp!
  status: CastingStatus! @default(value: DRAFT)
  requirements: [String!]
  images: [String!]
  createdAt: Timestamp! @default(expr: "now()")
  updatedAt: Timestamp! @default(expr: "now()")
  createdBy: User!
  
  # Relations
  applications: [CastingApplication!]!
  bookings: [Booking!]!
}

# Candidature à un casting
type CastingApplication @table(key: ["casting", "user"]) {
  casting: Casting!
  user: User!
  status: ApplicationStatus! @default(value: PENDING)
  message: String
  portfolioItems: [String!]
  submittedAt: Timestamp! @default(expr: "now()")
  updatedAt: Timestamp! @default(expr: "now()")
  
  # Évaluation
  rating: Int @constraint(min: 1, max: 5)
  notes: String
  reviewedBy: User
  reviewedAt: Timestamp
}

# Réservation/Booking
type Booking @table {
  id: ID! @default(expr: "uuidV4()")
  casting: Casting!
  model: User!
  status: BookingStatus! @default(value: PENDING)
  startTime: Timestamp!
  endTime: Timestamp!
  location: String
  notes: String
  rate: Float
  rateCurrency: String @default(value: "EUR")
  createdAt: Timestamp! @default(expr: "now()")
  updatedAt: Timestamp! @default(expr: "now()")
  createdBy: User!
}

# Types énumérés
enum UserRole {
  ADMIN
  MANAGER
  MODEL
  CLIENT
  GUEST
}

enum UserStatus {
  PENDING
  ACTIVE
  SUSPENDED
  REJECTED
}

enum CastingStatus {
  DRAFT
  OPEN
  IN_PROGRESS
  COMPLETED
  CANCELLED
}

enum ApplicationStatus {
  PENDING
  REVIEWED
  SHORTLISTED
  SELECTED
  REJECTED
}

enum BookingStatus {
  PENDING
  CONFIRMED
  COMPLETED
  CANCELLED
  NO_SHOW
}

# Types de requêtes personnalisées
type Query {
  # Requêtes pour les modèles
  searchModels(
    filters: ModelFilters
    sortBy: ModelSort
    limit: Int = 20
    offset: Int = 0
  ): [User!]!
  
  # Requêtes pour les castings
  upcomingCastings(
    limit: Int = 10
    offset: Int = 0
  ): [Casting!]!
  
  # Statistiques
  dashboardStats: DashboardStats!
}

# Filtres pour la recherche de modèles
input ModelFilters {
  heightMin: Int
  heightMax: Int
  ageMin: Int
  ageMax: Int
  eyeColor: [String!]
  hairColor: [String!]
  skills: [String!]
  availableFrom: Date
  availableTo: Date
}

# Options de tri pour les modèles
input ModelSort {
  field: ModelSortField! = CREATED_AT
  direction: SortDirection! = DESC
}

enum ModelSortField {
  CREATED_AT
  HEIGHT
  AGE
  RATING
}

enum SortDirection {
  ASC
  DESC
}

type DashboardStats {
  totalModels: Int!
  activeModels: Int!
  totalCastings: Int!
  openCastings: Int!
  pendingApplications: Int!
  upcomingBookings: Int!
  monthlyRevenue: Float!
}
